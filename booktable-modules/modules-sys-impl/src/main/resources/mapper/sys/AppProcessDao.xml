<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.booktable.modules.dao.sys.AppProcessDao">

	<sql id="TABLE_NAME">sp2p.app_role</sql>

	<sql id="INSERT_TITLE">
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="appRoleId != null">app_role_id,</if>
			<if test="processId != null">process_id,</if>
			<if test="userId != null">user_id,</if>
		</trim>
	</sql>

	<sql id="INSERT_DATA">
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="appRoleId != null">#{appRoleId},</if>
			<if test="processId != null">#{processId},</if>
			<if test="userId != null">#{userId},</if>
		</trim>
	</sql>

	<sql id="PAGE_SEARCH_ITEM">
		<if test="userName != null">and userName like CONCAT('%',#{userName},'%')</if>
		<if test="realName != null">and realName like CONCAT('%',#{realName},'%')</if>
	</sql>

	<resultMap id="processInfoMap" type="processInfoDo">
		<id column="process_id" property="processId" />
		<result column="process_name" property="processName" />
	</resultMap>

	<select id="queryListPage" resultType="sysUserDo">
		select
			id,userName,realName
		from
			sys_user
		where  status = 1
		<include refid="PAGE_SEARCH_ITEM" />

	</select>

	<select id="queryList" resultMap="processInfoMap">
		select
			process_id,process_name
		from
			sp2p.l_process_info
		where is_enable = "T"
	</select>

	<select id="queryProcessIdsByUserId" resultType="string">
		select
			process_id
		from
		<include refid="TABLE_NAME" />
		where user_id = #{value}
	</select>

	<insert id="insert" parameterType="appRoleDo">
		insert into
		<include refid="TABLE_NAME" />
		<include refid="INSERT_TITLE" />
		<include refid="INSERT_DATA" />
	</insert>

	<delete id="delete">
		delete from
		<include refid="TABLE_NAME" />
		where user_id = #{value}
	</delete>

</mapper>
